(executable
  ((name main)
  (libraries (oUnit))))

(rule
 ((targets (main.ml))
  (deps ( (glob_files tests.ml) (glob_files *tests.ml) (glob_files *Tests.ml) ))
  (action  (with-stdout-to ${@} (run
    ../../src/main.exe gen --framework ounit --sort
  )))))

(alias
 ((name   runtest)
  (deps   (main.exe (file main.expected)))
  (action (run diff -u main.expected main.ml))))
