(executable
  ((name main)
  (libraries (oUnit))))

(rule
 ((targets (main.ml))
  (deps ( (glob_files {tests.ml,*tests.ml,*Tests.ml}) ))
  (action  (with-stdout-to ${@} (run
    ../../../src/main.exe gen --framework ounit --sort --context
  )))))

(alias
 ((name   runtest)
  (deps   (main.exe (file main.expected)))
  (action (run diff -u main.expected main.ml))))
